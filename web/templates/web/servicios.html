{% extends "base/base.html" %}
{% load static %}

{% block title %}Servicios — Podas y Talas Isaías{% endblock %}

{% block content %}

<!-- 🌿 HERO -->
<section class="hero-servicios d-flex align-items-center justify-content-center text-center text-white">
  <div class="overlay"></div>
  <div class="container position-relative">
    <h1 class="fw-bold display-5 mb-3 animate__animated animate__fadeInDown">
      <i class="bi bi-tree-fill"></i> Nuestros Servicios
    </h1>
    <p class="lead animate__animated animate__fadeInUp text-light">
      Más de una década cuidando y manteniendo tus áreas verdes con excelencia.
    </p>
    <div class="divider mx-auto mt-3"></div>
  </div>
</section>

<!-- 🌳 SERVICIOS -->
<section class="py-5 bg-light">
  <div class="container">
    <h2 class="fw-bold text-success text-center mb-5" data-aos="fade-up">
      <i class="bi bi-tools"></i> Especialistas en cada detalle
    </h2>

    <div class="row g-4 justify-content-center">
      {% for s in services %}
      <div class="col-lg-4 col-md-6 col-sm-10" data-aos="zoom-in" data-aos-delay="{{ forloop.counter|add:'1' }}00">
        <div class="service-card shadow-lg border-0 rounded-4 h-100">
          
          {% if s.image %}
          <div class="service-img-wrapper">
            <img src="{{ s.image.url }}" alt="{{ s.title }}" class="service-img">
          </div>
          {% else %}
          <div class="service-img-wrapper">
            <img src="{% static 'img/logo.png' %}" alt="{{ s.title }}" class="service-img">
          </div>
          {% endif %}

          <div class="card-body p-4 text-center">
            <h5 class="fw-bold text-success mb-3 text-capitalize">{{ s.title }}</h5>
            <p class="text-muted">{{ s.description|truncatechars:120 }}</p>

            <div class="mt-3 d-flex justify-content-center gap-2">
              <button class="btn btn-success rounded-pill fw-semibold"
                      onclick="showService('{{ s.title|escapejs }}', '{{ s.description|escapejs }}', '{% if s.image %}{{ s.image.url }}{% else %}{{ default_logo }}{% endif %}')">
                <i class="bi bi-eye-fill"></i> Ver más
              </button>
              
              <a href="{% url 'web:contacto' %}" class="btn btn-outline-success rounded-pill fw-semibold">
                <i class="bi bi-chat-text"></i> Cotizar
              </a>
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="text-center text-muted">🌱 Aún no hay servicios registrados.</div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- ☘️ CTA FINAL -->
<section class="cta-servicios text-white text-center py-5">
  <div class="container" data-aos="zoom-in">
    <h2 class="fw-bold mb-3">Tu jardín, en manos expertas 🌳</h2>
    <p class="mb-4">Solicita tu presupuesto sin compromiso.</p>
    <a href="{% url 'web:contacto' %}" class="btn btn-light fw-semibold rounded-pill px-4 py-2">
      <i class="bi bi-send"></i> Contáctanos
    </a>
  </div>
</section>

<!-- 🎨 ESTILOS -->
<style>
.hero-servicios { background: url("{% static 'img/servicios.png' %}") center/cover no-repeat; min-height: 65vh; position: relative; }
.hero-servicios .overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 70, 35, 0.65);
}
.divider {
  width: 80px;
  height: 4px;
  background: #ffc107;
  border-radius: 2px;
}

/* Tarjetas */
.service-card {
  background: #fff;
  transition: all 0.4s ease;
  border-radius: 1rem;
  overflow: hidden;
}
.service-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}
.service-img-wrapper {
  height: 250px;
  overflow: hidden;
}
.service-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.4s ease;
}
.service-card:hover .service-img {
  transform: scale(1.05);
}

/* CTA */
.cta-servicios {
  background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 60%, #4caf50 100%);
}

/* SweetAlert estilo */
.swal2-popup {
  border-radius: 1.2rem !important;
  overflow: hidden !important;
}
.swal2-image {
  border-radius: 0.7rem;
  margin-bottom: 15px;
}
.swal2-title {
  color: #136a39 !important;
  font-weight: 700 !important;
}
.swal2-html-container {
  text-align: justify !important;
  color: #333 !important;
  font-size: 1rem !important;
}
</style>

<!-- 🔔 SCRIPT SweetAlert -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  const defaultLogo = "{% static 'img/logo.png' %}";

  function showService(title, description, imageUrl) {
    const image = imageUrl && imageUrl !== 'None' ? imageUrl : defaultLogo;
    Swal.fire({
      title: `<h3 class="fw-bold text-success">${title}</h3>`,
      html: `<p style="text-align:justify;">${description}</p>`,
      imageUrl: image,
      imageHeight: 280,
      background: '#fff',
      confirmButtonColor: '#2e7d32',
      confirmButtonText: 'Cerrar',
      showClass: {
        popup: 'animate__animated animate__zoomIn'
      },
      hideClass: {
        popup: 'animate__animated animate__fadeOutDown'
      }
    });
  }
</script>

<!-- Animaciones -->
<link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">
<script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
<script>
AOS.init({ duration: 1000, once: true });
</script>

{% endblock %}
