{% extends "base/base.html" %}
{% load static %}

{% block title %}Podas y Talas Isaias üå≥ | Servicios Profesionales en Santiago{% endblock %}
{% block meta_description %}Podas y Talas Isaias ofrece servicios de poda, tala y mantenimiento de √°rboles en toda la Regi√≥n Metropolitana. Seguridad, experiencia y maquinaria profesional a tu servicio.{% endblock %}
{% block content %}

<!-- üåø SECCI√ìN HERO CON VIDEO -->
<section class="hero-section position-relative">
  <video autoplay muted loop playsinline class="hero-video">
    <source src="{% static 'videos/1000419971.mp4' %}" type="video/mp4">
    Tu navegador no soporta el video.
  </video>

  <div class="hero-overlay d-flex flex-column justify-content-center align-items-center text-center text-white px-3">
    <h1 class="fw-bold display-5 mb-3 animate__animated animate__fadeInDown" style="text-shadow: 2px 2px 8px rgba(0,0,0,0.6);">
      Expertos en podas, talas y mantenimiento de √°reas verdes<br>
      con calidad y seguridad garantizada.
    </h1>
    <p class="lead mb-4 animate__animated animate__fadeInUp" style="text-shadow: 1px 1px 6px rgba(0,0,0,0.5);">
      Conf√≠a en profesionales con experiencia. Solicita tu presupuesto aqu√≠ mismo.
    </p>
  </div>
</section>

<!-- üßæ FORMULARIO DE PRESUPUESTO -->
<section id="presupuesto" class="py-5 bg-light">
  <div class="container">
    <h2 class="fw-bold text-success text-center mb-4" data-aos="fade-up">
      <i class="bi bi-clipboard-check"></i> Solicita tu Presupuesto
    </h2>

    <div class="card shadow p-4 mx-auto" style="max-width: 700px; border-radius: 20px;" data-aos="fade-up" data-aos-delay="100">
      <form method="POST" enctype="multipart/form-data" id="budgetForm">
        {% csrf_token %}
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label fw-semibold"><i class="bi bi-person"></i> Nombre completo</label>
            {{ form.name }}
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold"><i class="bi bi-envelope"></i> Correo electr√≥nico</label>
            {{ form.email }}
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold"><i class="bi bi-telephone"></i> Tel√©fono</label>
            {{ form.phone }}
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold"><i class="bi bi-geo-alt"></i> Comuna</label>
            {{ form.comuna }}
          </div>
          <div class="col-12">
            <label class="form-label fw-semibold"><i class="bi bi-chat-left-text"></i> Descripci√≥n</label>
            {{ form.description }}
          </div>
          <div class="col-12">
            <label class="form-label fw-semibold"><i class="bi bi-image"></i> Subir imagen (opcional)</label>
            {{ form.image }}
          </div>
          <div class="text-end mt-3">
            <button type="button" id="confirmButton" class="btn btn-success btn-lg px-4 shadow-sm rounded-4">
              <i class="bi bi-send"></i> Enviar Solicitud
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</section>

<!-- üå≥ SERVICIOS (actualizado igual que servicios.html) -->
<section class="py-5 bg-light">
  <div class="container">
    <h2 class="fw-bold text-success text-center mb-5" data-aos="fade-up">
      <i class="bi bi-tools"></i> Nuestros Servicios
    </h2>

    <div class="row g-4 justify-content-center">
      {% for s in services %}
      <div class="col-lg-4 col-md-6 col-sm-10" data-aos="zoom-in" data-aos-delay="{{ forloop.counter|add:'1' }}00">
        <div class="service-card shadow-lg border-0 rounded-4 h-100">
          
          {% if s.image %}
          <div class="service-img-wrapper">
            <img src="{{ s.image.url }}" alt="{{ s.title }}" class="service-img">
          </div>
          {% else %}
          <div class="service-img-wrapper">
            <img src="{% static 'img/logo.png' %}" alt="{{ s.title }}" class="service-img">
          </div>
          {% endif %}

          <div class="card-body p-4 text-center">
            <h5 class="fw-bold text-success mb-3 text-capitalize">{{ s.title }}</h5>
            <p class="text-muted">{{ s.description|truncatechars:120 }}</p>

            <div class="mt-3 d-flex justify-content-center gap-2">
              <button class="btn btn-success rounded-pill fw-semibold"
                      onclick="showService('{{ s.title|escapejs }}', '{{ s.description|escapejs }}', '{% if s.image %}{{ s.image.url }}{% else %}{{ default_logo }}{% endif %}')">
                <i class="bi bi-eye-fill"></i> Ver m√°s
              </button>
              
              <a href="{% url 'web:contacto' %}" class="btn btn-outline-success rounded-pill fw-semibold">
                <i class="bi bi-chat-text"></i> Cotizar
              </a>
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="text-center text-muted">üå± A√∫n no hay servicios registrados.</div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- üé• VIDEOS -->
<section id="videos" class="py-5 bg-white">
  <div class="container">
    <h2 class="fw-bold text-success text-center mb-5" data-aos="fade-up">
      <i class="bi bi-camera-reels"></i> Videos Destacados
    </h2>
    <div class="row g-4 justify-content-center">
      {% for v in videos %}
      <div class="col-lg-4 col-md-6 col-sm-8" data-aos="zoom-in" data-aos-delay="{{ forloop.counter|add:'1' }}00">
        <div class="video-card-pro shadow-lg rounded-4 overflow-hidden border border-success-subtle">
          <div class="ratio ratio-16x9 video-frame-wrapper">
            {% if v.video_file %}
              <video controls class="w-100 h-100" style="object-fit:cover;">
                <source src="{{ v.video_file.url }}" type="video/mp4">
              </video>
            {% elif v.video_url %}
              <iframe src="{{ v.video_url }}" allowfullscreen></iframe>
            {% else %}
              <div class="d-flex align-items-center justify-content-center bg-dark text-white">
                <span class="small text-secondary">Sin video disponible</span>
              </div>
            {% endif %}
          </div>
        </div>
        <p class="fw-semibold text-center mt-3">{{ v.title }}</p>
      </div>
      {% empty %}
      <div class="col-12 text-center text-muted">üé¨ A√∫n no hay videos disponibles.</div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- ‚òï ¬øPOR QU√â ELEGIRNOS? -->
<section class="py-5 choose-us-section">
  <div class="container text-center">
    <h2 class="fw-bold mb-5" data-aos="fade-up" style="font-size:2.3rem; color:#fff;">
      ¬øPor qu√© elegir a <span style="color:#e8c27c;">Podas y Talas Isa√≠as</span>?
    </h2>

    <div class="row g-4 justify-content-center">
      <div class="col-lg-6 col-xl-3" data-aos="zoom-in" data-aos-delay="100">
        <div class="choose-card h-100 shadow-lg">
          <div class="icon-box mb-3"><i class="bi bi-gear-wide-connected"></i></div>
          <h5 class="fw-bold mb-3">Profesionalismo Real</h5>
          <p>M√°s de una d√©cada entregando servicios de excelencia en podas, talas y mantenimiento, con personal especializado y maquinaria de primer nivel.</p>
        </div>
      </div>

      <div class="col-lg-6 col-xl-3" data-aos="zoom-in" data-aos-delay="200">
        <div class="choose-card h-100 shadow-lg">
          <div class="icon-box mb-3"><i class="bi bi-shield-lock"></i></div>
          <h5 class="fw-bold mb-3">Seguridad Garantizada</h5>
          <p>Trabajamos con protocolos certificados y aseguramos el bienestar de tu propiedad y de nuestro equipo en cada proyecto realizado.</p>
        </div>
      </div>

      <div class="col-lg-6 col-xl-3" data-aos="zoom-in" data-aos-delay="300">
        <div class="choose-card h-100 shadow-lg">
          <div class="icon-box mb-3"><i class="bi bi-hourglass-split"></i></div>
          <h5 class="fw-bold mb-3">Compromiso y Puntualidad</h5>
          <p>Cumplimos con cada cliente en tiempo y forma, ofreciendo resultados confiables, transparentes y de alta calidad.</p>
        </div>
      </div>

      <div class="col-lg-6 col-xl-3" data-aos="zoom-in" data-aos-delay="400">
        <div class="choose-card h-100 shadow-lg">
          <div class="icon-box mb-3"><i class="bi bi-flower3"></i></div>
          <h5 class="fw-bold mb-3">Respeto por la Naturaleza</h5>
          <p>Promovemos la sustentabilidad mediante pr√°cticas responsables, reciclando residuos vegetales y cuidando cada √°rbol con respeto y conciencia ecol√≥gica.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ‚úÖ SWEETALERT Y WHATSAPP -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
const defaultLogo = "{% static 'img/logo.png' %}";

function showService(title, description, imageUrl) {
  const image = imageUrl && imageUrl !== 'None' ? imageUrl : defaultLogo;
  Swal.fire({
    title: `<h3 class="fw-bold text-success">${title}</h3>`,
    html: `<p style="text-align:justify;">${description}</p>`,
    imageUrl: image,
    imageHeight: 280,
    background: '#fff',
    confirmButtonColor: '#2e7d32',
    confirmButtonText: 'Cerrar',
    showClass: { popup: 'animate__animated animate__zoomIn' },
    hideClass: { popup: 'animate__animated animate__fadeOutDown' }
  });
}

document.getElementById("confirmButton").addEventListener("click", function() {
  Swal.fire({
    title: "¬øEnviar solicitud de presupuesto?",
    text: "Verifica que tus datos sean correctos antes de continuar.",
    icon: "question",
    showCancelButton: true,
    confirmButtonColor: "#2e7d32",
    cancelButtonColor: "#d33",
    confirmButtonText: "S√≠, enviar",
    cancelButtonText: "Cancelar"
  }).then((r)=>{ if(r.isConfirmed){ document.getElementById("budgetForm").submit(); }});
});
</script>

<a href="https://api.whatsapp.com/send?phone=56927652097&text=Hola%20necesito%20una%20cotizaci%C3%B3n%20de%20podas%20y%20talas" class="whatsapp-float" target="_blank" rel="noopener"><i class="bi bi-whatsapp"></i></a>

<!-- üåà ESTILOS -->
<style>
.hero-section{position:relative;height:95vh;overflow:hidden;}
.hero-video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:brightness(1.1) contrast(1.1) saturate(1.3);}
.hero-overlay{position:relative;z-index:2;background:rgba(0,60,25,0.55);width:100%;height:100%;}
input,textarea,select{border-radius:10px!important;border:1.5px solid #cce3d0;padding:10px 12px;width:100%;transition:all .3s ease;}
input:focus,textarea:focus{border-color:#2e7d32;box-shadow:0 0 8px rgba(46,125,50,0.3);}
.service-card{background:#fff;transition:all 0.4s ease;border-radius:1rem;overflow:hidden;}
.service-card:hover{transform:translateY(-6px);box-shadow:0 10px 25px rgba(0,0,0,0.2);}
.service-img-wrapper{height:250px;overflow:hidden;}
.service-img{width:100%;height:100%;object-fit:cover;transition:transform 0.4s ease;}
.service-card:hover .service-img{transform:scale(1.05);}
</style>

{% endblock %}
